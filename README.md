# 鼠标左键长按语音输入程序

一个支持鼠标左键长按激活语音输入的Python程序，可以将语音转换为文字并自动输入。

## 功能特点

- 🖱️ **鼠标左键长按检测**：按住鼠标左键1.5秒激活语音输入
- 🎤 **语音录制**：使用系统麦克风进行实时语音录制
- 🗣️ **语音转文字**：使用Google语音识别服务将语音转换为文字
- ⌨️ **自动输入**：将识别的文字自动输入到当前焦点位置
- 🎛️ **可配置**：支持自定义长按时间、采样率等参数
- 🚪 **简单退出**：按ESC键安全退出程序

## 安装依赖

```bash
pip install -r requirements.txt
```

### 依赖说明

- `pyautogui` - 用于模拟键盘输入
- `pyaudio` - 音频录制
- `SpeechRecognition` - 语音识别
- `keyboard` - 键盘事件监听
- `pynput` - 鼠标事件监听

## 使用方法

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **运行程序**
   ```bash
   python mouse_voice_input.py
   ```

3. **使用说明**
   - 按住鼠标左键1.5秒开始语音录制
   - 说话进行语音输入
   - 释放鼠标左键停止录音
   - 识别的文字会自动输入到当前焦点位置
   - 按ESC键退出程序

## 配置选项

你可以在创建程序实例时自定义参数：

```python
# 自定义长按时间为2秒
app = MouseVoiceInput(long_press_duration=2.0)

# 自定义采样率
app = MouseVoiceInput(sample_rate=44100)
```

## 注意事项

1. **网络连接**：语音识别需要网络连接（使用Google语音识别服务）
2. **麦克风权限**：确保程序有访问麦克风的权限
3. **语音识别语言**：默认使用中文识别（zh-CN）
4. **安全性**：pyautogui的安全模式已禁用，请谨慎使用

## 故障排除

### 麦克风相关问题
- 检查系统麦克风权限
- 确保麦克风设备工作正常
- 调整音频采样率

### 语音识别问题
- 检查网络连接
- 尝试调整语音识别语言
- 确保发音清晰

### 权限问题
- 在Windows上可能需要以管理员身份运行
- 确保没有其他程序占用麦克风

## 系统要求

- Python 3.7+
- Windows/macOS/Linux
- 麦克风设备
- 网络连接

## 许可证

MIT License