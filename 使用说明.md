# 鼠标左键长按语音输入程序使用说明

## 项目文件结构

```
MouseClickVoice/
├── AudioCapture.cs          # 音频捕获模块
├── Config.cs               # 配置管理
├── MainWindow.xaml         # 主窗口界面
├── MainWindow.xaml.cs      # 主窗口逻辑
├── MouseHook.cs            # 鼠标事件检测
├── SpeechRecognition.cs    # 语音识别模块
├── TextSimulator.cs        # 文本输入模拟
├── App.xaml                # 应用程序定义
├── AssemblyInfo.cs         # 程序集信息
├── MouseClickVoice.csproj  # 项目文件
├── MouseClickVoice.sln     # 解决方案文件
├── README.md               # 项目说明文档
├── README-CS.md            # C#版本说明文档
└── 使用说明.md             # 本文件
```

## 快速开始

### 方法1: 直接运行（推荐）
双击 `MouseClickVoice.exe` 文件启动程序。

### 方法2: 使用 Visual Studio
1. 打开 `MouseClickVoice.sln`
2. 按 F5 或点击"启动"按钮运行

### 方法3: 使用命令行
```bash
# 运行项目
dotnet run

# 或构建后运行
dotnet build -c Release
bin\Release\net8.0-windows\win-x64\MouseClickVoice.exe
```

## 首次使用

1. **启动程序**
   - 直接运行 MouseClickVoice.exe
   - 或使用 Visual Studio 打开项目运行

2. **开启服务**
   - 点击主窗口的"开始服务"按钮

3. **使用程序**
   - 在任意可输入文本的地方，按住鼠标左键1.5秒
   - 听到提示音后开始说话
   - 松开鼠标左键停止录音
   - 识别的文字会自动输入到当前位置

## 配置说明

程序支持在主窗口界面中配置以下参数：

- **长按时间**: 0.5-3.0秒可调（默认1.5秒）
- **识别语言**: 中文(zh-CN) / 英文(en-US)
- **输入方式**: 键盘模拟 / 剪贴板粘贴
- **通知设置**: 开启/关闭状态通知
- **音频参数**: 采样率、声道数、位深度

配置会自动保存到 `config.json` 文件中。

## 语言支持

支持的语言代码：
- `zh-CN` - 中文（默认）
- `en-US` - 英文

基于 Windows 语音识别引擎，支持所有 Windows 系统已安装的语言包。

## 常见问题

### Q: 程序无法启动？
A:
1. 确保系统已安装 .NET 8.0 Runtime
2. 检查是否已启用 Windows 语音识别功能
3. 确保麦克风设备正常工作

### Q: 语音识别不准确？
A:
1. 运行 Windows 语音识别训练以提高准确率
2. 在安静环境中使用
3. 说话清晰，语速适中
4. 使用质量较好的麦克风

### Q: 鼠标操作不响应？
A:
1. 确保以管理员权限运行程序
2. 检查是否有其他鼠标钩子程序冲突
3. 尝试重新启动程序

### Q: 如何退出程序？
A: 点击主窗口的"停止服务"按钮，或直接关闭窗口退出。

## 使用场景

- **写作辅助**: 快速输入长文本
- **编程辅助**: 语音输入代码注释
- **聊天工具**: 快速回复消息
- **文档编辑**: 语音输入文档内容
- **无障碍辅助**: 为有输入困难的用户提供帮助

## 注意事项

1. **系统要求**: Windows 10/11 系统
2. **语音功能**: 需要启用 Windows 语音识别功能
3. **麦克风权限**: 确保程序有麦克风访问权限
4. **管理员权限**: 建议以管理员身份运行以获得全局鼠标钩子权限
5. **隐私保护**: 语音识别使用 Windows 本地引擎，数据不会上传到外部服务器

## 故障排除

### 构建/编译问题
```bash
# 清理并重新构建
dotnet clean
dotnet build -c Release

# 还原依赖
dotnet restore
```

### 音频设备问题
- 打开 Windows 设置 → 系统 → 声音
- 检查麦克风是否为默认设备
- 测试麦克风是否正常工作

### Windows 语音识别功能
1. 打开控制面板 → 时钟和区域 → 语言
2. 添加所需的语言包
3. 启用语音识别功能

### 权限问题
- Windows: 右键程序选择"以管理员身份运行"
- 在 Windows 设置中授予麦克风访问权限

## 技术支持

如果遇到问题，请检查：
1. .NET 8.0 Runtime 是否已安装
2. Windows 语音识别功能是否已启用
3. 麦克风是否工作正常
4. 是否以管理员权限运行

## 开发信息

### 构建单文件发布版本
```bash
dotnet publish -c Release -r win-x64 --self-contained true -p:PublishSingleFile=true
```
输出文件位于：`bin\Release\net8.0-windows\win-x64\publish\MouseVoiceInput.exe`

### 系统要求
- Windows 10/11
- .NET 8.0 Runtime（发布版本已包含）
- 麦克风设备
- Windows 语音识别功能

### 技术栈
- **框架**: .NET 8.0 + WPF
- **音频**: NAudio 2.2.1
- **语音识别**: System.Speech (Windows 原生)
- **架构**: x64

---

**享受语音输入的便捷！**